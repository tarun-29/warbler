{"ast":null,"code":"import _objectWithoutProperties from \"/Users/tarunkantiwal/Desktop/React/warbler/client/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport { apiCall, setTokenHeader } from \"../../services/api\";\nimport { SET_CURRENT_USER } from \"../actionTypes\";\nimport { addError, removeError } from \"../actions/error\";\nexport function setCurrentUser(user) {\n  return {\n    type: SET_CURRENT_USER,\n    user\n  };\n}\nexport function setAuthorizationToken(token) {\n  setTokenHeader(token);\n}\nexport function logout() {\n  return dispatch => {\n    localStorage.clear();\n    dispatch(setCurrentUser({}));\n  };\n}\nexport function authUser(type, userData) {\n  return dispatch => {\n    // wrap our thunk in a promise so we can wait for the API call\n    return new Promise((resolve, reject) => {\n      return apiCall(\"post\", `/api/auth/${type}`, userData).then((_ref) => {\n        let token = _ref.token,\n            user = _objectWithoutProperties(_ref, [\"token\"]);\n\n        localStorage.setItem(\"jwtToken\", token);\n        setAuthorizationToken(token);\n        dispatch(setCurrentUser(user));\n        dispatch(removeError());\n        resolve();\n      }).catch(err => {\n        dispatch(addError(err.message));\n        reject();\n      });\n    });\n  };\n}","map":{"version":3,"sources":["/Users/tarunkantiwal/Desktop/React/warbler/client/src/store/actions/auth.js"],"names":["apiCall","setTokenHeader","SET_CURRENT_USER","addError","removeError","setCurrentUser","user","type","setAuthorizationToken","token","logout","dispatch","localStorage","clear","authUser","userData","Promise","resolve","reject","then","setItem","catch","err","message"],"mappings":";AAAA,SAASA,OAAT,EAAkBC,cAAlB,QAAwC,oBAAxC;AACA,SAASC,gBAAT,QAAiC,gBAAjC;AACA,SAASC,QAAT,EAAmBC,WAAnB,QAAsC,kBAAtC;AAEA,OAAO,SAASC,cAAT,CAAwBC,IAAxB,EAA8B;AACnC,SAAO;AACLC,IAAAA,IAAI,EAAEL,gBADD;AAELI,IAAAA;AAFK,GAAP;AAID;AAED,OAAO,SAASE,qBAAT,CAA+BC,KAA/B,EAAsC;AACzCR,EAAAA,cAAc,CAACQ,KAAD,CAAd;AACH;AAED,OAAO,SAASC,MAAT,GAAiB;AACtB,SAAOC,QAAQ,IAAG;AAChBC,IAAAA,YAAY,CAACC,KAAb;AACAF,IAAAA,QAAQ,CAACN,cAAc,CAAC,EAAD,CAAf,CAAR;AACD,GAHD;AAID;AAED,OAAO,SAASS,QAAT,CAAkBP,IAAlB,EAAwBQ,QAAxB,EAAkC;AACvC,SAAOJ,QAAQ,IAAI;AACjB;AACA,WAAO,IAAIK,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,aAAOlB,OAAO,CAAC,MAAD,EAAU,aAAYO,IAAK,EAA3B,EAA8BQ,QAA9B,CAAP,CACJI,IADI,CACC,UAAwB;AAAA,YAArBV,KAAqB,QAArBA,KAAqB;AAAA,YAAXH,IAAW;;AAC5BM,QAAAA,YAAY,CAACQ,OAAb,CAAqB,UAArB,EAAiCX,KAAjC;AACAD,QAAAA,qBAAqB,CAACC,KAAD,CAArB;AACAE,QAAAA,QAAQ,CAACN,cAAc,CAACC,IAAD,CAAf,CAAR;AACAK,QAAAA,QAAQ,CAACP,WAAW,EAAZ,CAAR;AACAa,QAAAA,OAAO;AACR,OAPI,EAQJI,KARI,CAQEC,GAAG,IAAI;AACZX,QAAAA,QAAQ,CAACR,QAAQ,CAACmB,GAAG,CAACC,OAAL,CAAT,CAAR;AACAL,QAAAA,MAAM;AACP,OAXI,CAAP;AAYD,KAbM,CAAP;AAcD,GAhBD;AAiBD","sourcesContent":["import { apiCall, setTokenHeader } from \"../../services/api\";\nimport { SET_CURRENT_USER } from \"../actionTypes\";\nimport { addError, removeError } from \"../actions/error\";\n\nexport function setCurrentUser(user) {\n  return {\n    type: SET_CURRENT_USER,\n    user\n  };\n}\n\nexport function setAuthorizationToken(token) {\n    setTokenHeader(token)\n}\n\nexport function logout(){\n  return dispatch =>{\n    localStorage.clear();\n    dispatch(setCurrentUser({}));\n  }\n}\n\nexport function authUser(type, userData) {\n  return dispatch => {\n    // wrap our thunk in a promise so we can wait for the API call\n    return new Promise((resolve, reject) => {\n      return apiCall(\"post\", `/api/auth/${type}`, userData)\n        .then(({ token, ...user }) => {\n          localStorage.setItem(\"jwtToken\", token);\n          setAuthorizationToken(token)\n          dispatch(setCurrentUser(user));\n          dispatch(removeError());\n          resolve();\n        })\n        .catch(err => {\n          dispatch(addError(err.message));\n          reject();\n        });\n    });\n  };\n}\n"]},"metadata":{},"sourceType":"module"}